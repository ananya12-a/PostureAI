
var demo_keypoints = { "landmarks": [ { "x": 0.5526425838470459, "y": 0.07409875839948654, "z": -0.04876197874546051, "visibility": 0.9985257387161255 }, { "x": 0.5603811144828796, "y": 0.060850873589515686, "z": -0.06689874827861786, "visibility": 0.9983115792274475 }, { "x": 0.5619347095489502, "y": 0.061112578958272934, "z": -0.06689800322055817, "visibility": 0.9989592432975769 }, { "x": 0.5634281039237976, "y": 0.06111324205994606, "z": -0.06689736992120743, "visibility": 0.9987589716911316 }, { "x": 0.5595465302467346, "y": 0.060588207095861435, "z": -0.03511466458439827, "visibility": 0.998349666595459 }, { "x": 0.5604655742645264, "y": 0.06066906079649925, "z": -0.0351974256336689, "visibility": 0.998650848865509 }, { "x": 0.5613363981246948, "y": 0.06064693629741669, "z": -0.03521858900785446, "visibility": 0.9984714984893799 }, { "x": 0.5753670930862427, "y": 0.07326927781105042, "z": -0.10817670822143555, "visibility": 0.9989438056945801 }, { "x": 0.5721713304519653, "y": 0.07240479439496994, "z": 0.03711504489183426, "visibility": 0.9992105960845947 }, { "x": 0.5564740896224976, "y": 0.09361246228218079, "z": -0.061045289039611816, "visibility": 0.996569037437439 }, { "x": 0.5551309585571289, "y": 0.09259103238582611, "z": -0.01929132081568241, "visibility": 0.994663417339325 }, { "x": 0.5892980098724365, "y": 0.1564626544713974, "z": -0.16267019510269165, "visibility": 0.9990055561065674 }, { "x": 0.5731342434883118, "y": 0.16778899729251862, "z": 0.12623420357704163, "visibility": 0.9766095876693726 }, { "x": 0.576950192451477, "y": 0.05438905209302902, "z": -0.23680531978607178, "visibility": 0.919523298740387 }, { "x": 0.5600987076759338, "y": 0.09934522956609726, "z": 0.3029748499393463, "visibility": 0.02828485332429409 }, { "x": 0.5862019658088684, "y": 0.06327543407678604, "z": -0.17277644574642181, "visibility": 0.4583503305912018 }, { "x": 0.5796104073524475, "y": 0.0812712237238884, "z": 0.45578718185424805, "visibility": 0.013649240136146545 }, { "x": 0.591915488243103, "y": 0.06831640005111694, "z": -0.1837991178035736, "visibility": 0.36401399970054626 }, { "x": 0.5877729654312134, "y": 0.0731336772441864, "z": 0.4850704073905945, "visibility": 0.022444840520620346 }, { "x": 0.5936087369918823, "y": 0.07096903771162033, "z": -0.17507663369178772, "visibility": 0.36269325017929077 }, { "x": 0.5878034234046936, "y": 0.07534134387969971, "z": 0.47946563363075256, "visibility": 0.023579096421599388 }, { "x": 0.5932305455207825, "y": 0.0793127790093422, "z": -0.1683330237865448, "visibility": 0.3548416197299957 }, { "x": 0.5873113870620728, "y": 0.07779908180236816, "z": 0.4554530680179596, "visibility": 0.026188766583800316 }, { "x": 0.6025286912918091, "y": 0.44036075472831726, "z": -0.10655375570058823, "visibility": 0.9996986985206604 }, { "x": 0.5921331644058228, "y": 0.4435378611087799, "z": 0.10665023326873779, "visibility": 0.9987775087356567 }, { "x": 0.5980120897293091, "y": 0.6498152017593384, "z": -0.09176476299762726, "visibility": 0.9710323214530945 }, { "x": 0.5931881070137024, "y": 0.6396476030349731, "z": 0.19282673299312592, "visibility": 0.3475714921951294 }, { "x": 0.6121034622192383, "y": 0.8562979102134705, "z": -0.09422802925109863, "visibility": 0.9773259162902832 }, { "x": 0.6007257103919983, "y": 0.8169824481010437, "z": 0.29564163088798523, "visibility": 0.5274920463562012 }, { "x": 0.626386284828186, "y": 0.894924521446228, "z": -0.09770959615707397, "visibility": 0.9379950761795044 }, { "x": 0.6118261218070984, "y": 0.8492575883865356, "z": 0.3023696541786194, "visibility": 0.5516166687011719 }, { "x": 0.5591077208518982, "y": 0.9068337082862854, "z": -0.17866571247577667, "visibility": 0.9667404294013977 }, { "x": 0.5540019869804382, "y": 0.8560253381729126, "z": 0.2617959678173065, "visibility": 0.6672569513320923 } ], "POSE_CONNECTIONS": [ [ 0, 1 ], [ 1, 2 ], [ 2, 3 ], [ 3, 7 ], [ 0, 4 ], [ 4, 5 ], [ 5, 6 ], [ 6, 8 ], [ 9, 10 ], [ 11, 12 ], [ 11, 13 ], [ 13, 15 ], [ 15, 17 ], [ 15, 19 ], [ 15, 21 ], [ 17, 19 ], [ 12, 14 ], [ 14, 16 ], [ 16, 18 ], [ 16, 20 ], [ 16, 22 ], [ 18, 20 ], [ 11, 23 ], [ 12, 24 ], [ 23, 24 ], [ 23, 25 ], [ 24, 26 ], [ 25, 27 ], [ 26, 28 ], [ 27, 29 ], [ 28, 30 ], [ 29, 31 ], [ 30, 32 ], [ 27, 31 ], [ 28, 32 ] ], "pc_length": 35, "l_length": 33 }

/*
Sunburst chart - user profile page - inner ring for exercises divided by time spent per exercise and outter ring for split up of average score in good, okay, bad
Pie chart - dashboard - full video average classification into good, okay, bad
line plot - dashboard - individual score + average scores through the video
line plot - user profile - average score per exercise again time of video upload
heatmap - user profile - usage/visit frequency/density
*/


function unpack(keypoints, coordinate) {
    var result = []
    for(let i = 0; i < keypoints["landmarks"].length; i++) {
        result[i] = keypoints["landmarks"][i][coordinate]
    }
    return result
}

function keypoints3D(keypoints, divName = 'myDiv') {
    var x = unpack(demo_keypoints, 'x')
    var y = unpack(demo_keypoints, 'y')
    var z = unpack(demo_keypoints, 'z')
    var markers = {
        x: x, y: y, z: z,
        mode: 'markers+text',
        text: [...Array(keypoints["landmarks"].length).keys()],
        marker: {
            size: 12,
            line: {
                color: 'rgba(217, 217, 217, 0.14)',
                width: 0.5
            },
            opacity: 0.8,
        },
        type: 'scatter3d'
    };
    var x_lines = []
    var y_lines = []
    var z_lines = []
    pairs = keypoints["POSE_CONNECTIONS"]
    for(let j = 0; j < pairs.length; j++){
        pair = pairs[j]
        for(let i = 0; i<2; i++){
            x_lines.push(x[pair[i]])
            y_lines.push(y[pair[i]])
            z_lines.push(z[pair[i]])
        }
        x_lines.push(undefined)
        y_lines.push(undefined)
        z_lines.push(undefined)
    }
    console.log(x_lines)
    var lines = {
        x: x_lines, y: y_lines, z:z_lines,
        mode: 'lines',
        type:'scatter3d',
    }
    var data = [markers, lines];
    var layout = {
        margin: {
            l: 0,
            r: 0,
            b: 0,
            t: 0
        }
    };
    Plotly.newPlot(divName, data, layout);
}
keypoints3D(demo_keypoints)